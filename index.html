---
layout: default
title: Главная
h1: Справочный портал в мире информационных технологий
sidebar-path: sidebar-L/sidebar-L-default.html
---

<article class="article-box"> <!--rsync-->
    <header class="article-header"><h2>rsync</h2></header>
    <p>
        Должна быть установлена на всех машинах.
    </p>
    <p>
        В <span class="rsync">rsync</span> всегда, сначала указываем <span class="rsync">источник</span>, а потом
        <span class="rsync">место назначения</span>, т.е сначала что копируем, а потом куда копируем.<br>
        Всегда используйте<span class="rsync"> параметр -nv перед прогоном</span>. rsync может натворить огромную
        головную боль если что-то не так сделать.
    </p>
    <hr class="custom-hr" />
    <h3>Завершающий слеш "/"</h3>
    <p>
        Источник<span class="attention"> без завершающего слеша скопирует сам каталог</span>
        <span class="path">/path/dir</span> в удаленный каталог
        <span class="path">/dest_dir</span>:<br>
        <code class="path"><span class="local"></span>]<span style="color:royalblue;">$</span>
            rsync -a /path/dir user@host:dest_dir
        </code>
    </p>

    <p>Путь к каталогу источнику <span class="attention">с косой чертой в конце </span>скопирует
        <span class="attention">не сам каталог</span> <span class="path">/path/dir</span>,
        а все содержимое в удаленный каталог <span class="path">/dest_dir</span>:<br>
        <code class="path"><span class="local"></span>]<span style="color:royalblue;">$</span>
            rsync -a /path/dir/ user@host:dest_dir
        </code>
    </p>
    <hr class="custom-hr" />
<!-- h3 "Завершающий слеш"-->
    <h3>Небольшая инструкция по синхронизации</h3>
    <ol class="instruction-list">
        <li>
            <p>Синхронизируем локальный каталог с удаленным сервером:<br>
                <code class="path"><span class="local"></span>]<span style="color: royalblue">$</span>
                    rsync -a -e "ssh -p 7967" html/ user@host:html/</code>
            </p>
            <p class="note">
                <span>Примечание</span>: <code class="path">-e "ssh -p 7967"</code> указывает коннектиться по определенному порту.
            </p>
        </li>
        <li>
            <p>
                На удаленной машине синхронизируем каталоги:<br>
                <code class="path"><span class="remote"></span>]<span style="color: royalblue">$</span>
                    rsync -a html/ /var/www/html/
                </code>
            </p>
        </li>
    </ol>
    <hr class="custom-hr" />
    <h3>Исключить каталог из операции переноса</h3>
    <p>
        <code class="path"><span class="local"></span>]<span style="color:royalblue;">$</span>
            rsync -a -e "ssh -p 7967" --exclude 'res/header' html/ user@host:html/
        </code>
    </p>
</article> <!-- закрытие rsync-->

<article class="article-box">
    <header class="article-header"><h2>Команда scp</h2></header>    <!-- Команда csp -->
    <p><dfn>scp</dfn> - копирует файлы между хостами в Сети. Работает подобно команде <i>cp</i></p>

    <p>Примеры:</p>
    <ul>
        <li>
            <p>
                <b>Файл</b> с удаленного хоста к себе в текущую директорию -
                <code class="path"><span class="local"></span>]<span style="color:royalblue">$</span>
                    scp user@host:path_file path_copy_past
                </code>
            </p>
        </li>
        <li>
            <p>
                <b>Каталог</b> с удаленного хоста через <b>другой порт</b> -
                <code class="path"><span class="local"></span>]<span style="color:royalblue">$</span>
                    scp -r -P 2871 user@host:path_file path_copy_past
                </code>
            </p>
        </li>
    </ul>
    <p class="note-attention">Внимание: для scp порт указывается с большой "P".</p>

</article> <!--закрытие "Команда scp"-->

<article class="article-box">
    <header class="article-header">
        <h2 class="grid-article-h2">Инструкция по настройке сервера</h2>
    </header>

    <h3>1. Создаем пользователя с правами sudo</h3>
        <ul>
            <li>
                <p>
                    <code class="text-code-box">
                        <span class="root"></span> <span style="color: royalblue">#</span> useradd <i>new_username</i>
                    </code> - добавляем пользователя.
                </p>
            </li>
            <li>
                <p>
                    <code class="text-code-box">
                        <span class="root"></span> <span style="color: royalblue">#</span> passwd <i>new_username</i>
                    </code> - задаем ему пароль.
                </p>
            </li>
            <li>
                <p>
                    <code class="text-code-box">
                        <span class="root"></span> <span style="color: royalblue">#</span> usermod -aG
                        <i>group_name1 group_name2... user_name</i>
                    </code> - добавляем пользователя в группу <b>wheel</b>.
                </p>
            </li>
        </ul>
        <p>Выходим из сессии root и заходим под новым пользователем.</p>

    <h3>2. Настройка SSH</h3>
        <p>
            Примечание. Для настройки ключей-SSH в Windows 11, читай <a href="pages/ssh-keys-windows.html">Настройки
            ключей-ssh в системе Windows</a>
        </p>
        <ul>
            <li><code>~] $ssh-keygen</code> - на клиенте генерируем пару ключей.</li>
            <li><code>~] $ssh-copy-id user@host</code> - копируем открытый ключ на удаленный сервер.</li>
            <li>Отключаем аутентификацию по паролю (в файле /etc/ssh/sshd_config) - <b>PasswordAuthentication no</b></li>
            <li>Запрещаем логиниться от root (в файле /etc/ssh/sshd_config) - <b>PermitRootLogin no</b></li>
            <li>Меняем порт (в файле /etc/ssh/sshd_config) - <b>Port #номер</b></li>
            <li>Перезагружаем сервер <code>~]# systemct reload sshd</code></li>
            <li>
                Далее нужно проверить, включен ли SeLinux:
                <code>$ sestatus</code>
                если да, то обновляем политику SeLinux чтобы разрешить использование этого порта:
                <ul>
                    <li><code>~]# yum install policycoreutils-python-utils</code></li>
                    <li><code>~]# semanage port -a -t ssh_port_t -p tcp #номер</code></li>
                </ul>
                если SeLinux отключен, тогда просто открываем порт.
            </li>
            <li>
                Открываем порт в firewall
                <ul>
                    <li># firewall-cmd --add-port #номер/tcp</li>
                    <li># firewall-cmd --runtime-to-permanent</li>
                </ul>
            </li>
        </ul>
        <p>Начальная настройка завершена.</p>

    <!-- Потомок grida -->
    <div class="instr3">
        <h3>3. Установка web-серевера Apache</h3><!--Установка web-серевера Apache-->
        <ul>
            <li><code>~]# yum install <i>httpd</i></code></li>
            <li><code>~]$ sudo systemctl enable httpd --now</code></li>
            <li><code>~]# firewall-cmd --zone=public --add-service=http --permanent</code></li>
            <li><code>~]# firewall-cmd --reload</code></li>
        </ul>
        <p>Готово</p>
        <h3>3. Установка Nginx</h2>
            <p><a href="https://nginx.org/ru/">Перейти на официальный сайт ngix.org</a></p>
            <p><a href="https://nginx.org/ru/docs/">Читать документацию по Nginx</a></p>
            <p>Nginix - модульный сервер. Реализует различные сцеанарии веб-серверов.В первую очередь Nginx это конечно же (сценарий) веб-сервер, но помимо этого он умеет выполнять функцию (сценарий) обратного проксирования, и даже (сценарий) балансировку нагрузки.</p>
            <div>
                <ul>
                    <li><code>yum repolist</code></li>
                    <li>Для установки Ngnix нужно 1)выбрать <b>поток</b> и выполнить установку; 2)открыть порт в межсетевом экране; 3)настроить автоматический запуск для службы nginx.</li>
                    <li><code>yum modules list nginx </code> - вывести список модулей которые содержит Nginx. прим. Поток по умолчание обозначен "[d]".  </li>
                    <li><code># yum install nginx</code></li>
                    <li><code># firewall-cmd --list-all</code> - убедимся что по умолчанию <i>отсутствует разрешение на доступ по 80 порту.</i></li>
                    <li>
                        <p>добавим 80-ый порт в виде сервиса, сервис назывется "http"</p>
                        <p><code>firewall-cmd --add-service=http </code> - это комнда добавит в активную конфигурацию</p>
                        <p><code>firewall-cmd --add-service=http --permanent</code> - но также добавим и в постоянную конфигурацию</p>
                        <p><code># firewall-cmd --list-all</code> - проверяем.</p>
                    </li>
                    <li>
                        <p><code>~]$ systemctl status nginx.service</code> проверяем статус службы.</p>
                        <p><code>~]$ systemctl status nginx.service</code> - включаем и добавляем в автозапуск.</p>
                    </li>
                </ul>
                <p>После этого, технически уже можно начать пользоваться сервером. Вводите в браузере ip-адрес или доменное имя и проверяте.</p>
                <h3>Конфигурация по умолчанию.</h3>
                <p>Конфигурационный файл - /etc/nginx/nginx.conf . В нём веб-сервер настроен на работу на 80 порту, и намечен на каталог контента в /usr/share/nginx/html/</p>
                <img src="/images/server/nginx_defolt_config.png" alt="default config Nginx" />
            </div>
            <h4>3.2 Настройка записей DNS</h4>
            <p>Нужно в <strong>запись А</strong> добавить ip-адрес сервера. Для <b>www.you_name_domain.ru</b> и для <b>you_name_domain.ru</b> </p>
    </div>


</article>